{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyecto de Software</title>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">

    <!-- CSS adicional para mejorar los botones -->
    <style>
        .button-div:hover {
            transform: scale(1.1);
        }
        .button-text {
            color: white;
            font-weight: bold;
            font-size: 1.2em;
        }
    </style>
</head>
<body class="d-flex flex-column min-vh-100">

    <!-- Encabezado -->
    <header class="d-flex align-items-center border p-3">
        <div class="logos">
            <img src="{% static 'home/Logo1.png' %}" alt="Logo" width="60" height="auto">
            <img src="{% static 'home/Logo2.png' %}" alt="Logo2" width="250" height="auto">
        </div>
        <div class="ml-auto d-flex align-items-center">
            <a href="{% url 'body' %}" class="btn gradient-btn mr-3" style="color: #651616; font-size: 17px;"><strong>Inicio</strong></a>
            <a href="{% url 'contacto' %}" class="btn gradient-btn mr-3" style="color: #651616; font-size: 17px;"><strong>Contacto</strong></a>
            <div class="input-group" style="margin-right: 20px;">
                <input type="text" class="form-control form-control-lg" placeholder="Buscar...">
                <div class="input-group-append">
                    <span class="input-group-text">
                        <i class="fas fa-search"></i>
                    </span>
                </div>
            </div>
        </div>        
    </header>

    <!-- Barra de navegación en el aside -->
    <aside>
        <nav class="navbar navbar-expand-lg navbar-light" style="background: linear-gradient(to right, #8a2626, #300707); box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1); height: 50px;">
            <ul class="navbar-nav mx-auto">
                <li class="nav-item mx-5">
                    <a class="nav-link" href="pronostico_mp10.html" style="color: #fff; padding: 5px; font-size: 18px; font-weight: bold;">Pronóstico MP10</a>
                </li>
                <li class="nav-item mx-5">
                    <a class="nav-link" href="estaciones.html" style="color: #fff; padding: 5px; font-size: 18px; font-weight: bold;">Estaciones</a>
                </li>
                <li class="nav-item mx-5">
                    <a class="nav-link" href="datos_historicos.html" style="color: #fff; padding: 5px; font-size: 18px; font-weight: bold;">Datos Históricos</a>
                </li>
            </ul>
        </nav>
    </aside>

    <!-- Contenido principal -->
    <main class="d-flex flex-grow-1 border flex-column flex-md-row">
        <aside class="border col-12 col-md-3" style="min-height: 450px;">
            <h4 class="text-center" style="color: #681f1f; margin-bottom: 10px; font-weight: bold; font-size: 1.2em;">MP10 DE HOY</h4>
            <div class="location" style="margin-bottom: 5px;">
                <!-- Contenido del aside -->
            </div>
        </aside>
        <section class="border col-12 col-md-9" style="min-height: 450px;">
            <!-- Contenido de la sección -->
            <div id="map" style="height: 450px;"></div>
        </section>
    </main>

    <section class="section-buttons" style="padding: 10px 110px;">
        <div class="button-container d-flex align-items-start m-1" style="width: 100%; height: 120px;">
            <a href="proyecto.html" class="button-div border btn-1" style="text-decoration: none; flex: 0 0 120px; height: 120px; border-radius: 8px; background: url({% static 'home/Boton1.png' %}) no-repeat center center; background-size: cover; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
            </a>
            <div class="description p-2" style="flex: 1;">
                <h4 style="color: maroon;">PROPÓSITO DEL PROYECTO</h4>
                <p>Este proyecto se enfoca en predecir los niveles de MP10 y proporcionar una escala de impacto en los cultivos para ayudar a los agricultores a proteger sus cosechas. <a href="proyecto.html">Ver más...</a></p>
            </div>
        </div>
    </section>
        
    <section class="section-buttons" style="padding: 0px 110px;">
        <div class="button-container d-flex align-items-start m-1" style="width: 100%; height: 120px;">
            <a href="mp10.html" class="button-div border btn-2" style="text-decoration: none; flex: 0 0 120px; height: 120px; border-radius: 8px; background: url({% static 'home/Boton2.png' %}) no-repeat center center; background-size: cover; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
            </a>
            <div class="description p-2" style="flex: 1;">
                <h4 style="color: maroon;">MP10 EN EL AIRE</h4>
                <p>La presencia del MP10 en el aire puede tener un impacto significativo en el sector agrícola, afectando negativamente la salud de los cultivos. <a href="mp10.html">Ver más...</a></p>
            </div>
        </div>
    </section>
    
    <section class="section-buttons" style="padding: 5px 110px;">
        <div class="button-container d-flex align-items-start m-1" style="width: 100%; height: 120px;">
            <a href="quienesomos.html" class="button-div border btn-3" style="text-decoration: none; flex: 0 0 120px; height: 100px; border-radius: 8px; background: url({% static 'home/Boton3.png' %}) no-repeat center center; background-size: cover; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
            </a>
            <div class="description p-2" style="flex: 1;">
                <h4 style="color: maroon;">CONÓCENOS</h4>
                <p>Somos un equipo de estudiantes dedicados a proporcionar información sobre los niveles de MP10 y su impacto en los cultivos, comprometidos con la precisión, responsabilidad ambiental y agrícola. <a href="quienesomos.html">Ver más...</a></p>
            </div>
        </div>
    </section>
    

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Función para leer el archivo CSV y mostrar los marcadores en el mapa
        function leerCSV() {
            fetch("{% static 'csv_files/coordenadas.csv' %}")
                .then(response => response.text())
                .then(data => {
                    const map = L.map('map').setView([-30.9, -71], 8); // Coordenadas del centro del mapa y nivel de zoom                

                    // Creamos una capa de Mapbox Streets
                    var streetsLayer = L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token={accessToken}', {
                        maxZoom: 18,
                        tileSize: 512,
                        zoomOffset: -1,
                        accessToken: 'pk.eyJ1IjoiZGFuaWtraSIsImEiOiJjbHdwczh0YjQxcGMwMnFwZ3B4dDBhOGlyIn0.f80sAhtZxhn0smqBNLZC0w'
                    });

                    // Agregamos ambas capas al mapa
                    streetsLayer.addTo(map);

                    // Dividir el CSV en líneas
                    const lines = data.split('\n');
                    
                    // Iterar sobre cada línea del CSV
                    lines.forEach(line => {
                        const [nombre, latitud, longitud] = line.split(',');
                        
                        // Convertir latitud y longitud a números
                        const lat = parseFloat(latitud);
                        const lng = parseFloat(longitud);
                        
                        // Crear marcador y añadirlo al mapa
                        L.marker([lat, lng]).addTo(map).bindPopup(nombre);
                    });
                });
        }

        // Llamar a la función para leer el CSV cuando se cargue la página
        window.onload = leerCSV;
    </script>

    <!-- Pie de página -->
    <footer class="mt-auto py-3" style="background-color: #8a2626; color: #fff; text-align: center;">
        <div class="container">
            <p class="mb-0">&copy; 2024 Proyecto de Software</p>
        </div>
    </footer>
    
    <!-- Bootstrap JS, Popper.js, and jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>

